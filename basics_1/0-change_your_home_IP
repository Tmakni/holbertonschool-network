#!/usr/bin/env bash
# localhost -> 127.0.0.2 ; facebook.com -> 8.8.8.8

# Si une ligne mappe 127.0.0.1 à localhost, on la remplace ; sinon on ajoute notre mapping en tête
if grep -qE '^127\.0\.0\.1[[:space:]]+localhost(\b|$)' /etc/hosts; then
  sed -i -E 's/^127\.0\.0\.1[[:space:]]+localhost(\b.*)?$/127.0.0.2 localhost/' /etc/hosts
else
  sed -i '1i 127.0.0.2 localhost' /etc/hosts
fi

# On retire tout mapping existant de facebook.com puis on ajoute le bon
sed -i -E '/(^|[[:space:]])facebook\.com([[:space:]]|$)/d' /etc/hosts
echo '8.8.8.8 facebook.com' >> /etc/hosts
